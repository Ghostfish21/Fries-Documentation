<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="built-on" content="2025-08-17T17:42:39.0778898"><title>Custom Data | Fries</title><script type="application/json" id="virtual-toc-data">[{"id":"z38cio7_4","level":0,"title":"三种不同的 属性","anchor":"#z38cio7_4"},{"id":"z38cio7_5","level":0,"title":"快速开始","anchor":"#z38cio7_5"},{"id":"customdata","level":0,"title":"CustomData 扩展方法文档","anchor":"#customdata"},{"id":"api","level":0,"title":"API 详细说明","anchor":"#api"},{"id":"customdatatype","level":0,"title":"自定义 CustomDataType 引导","anchor":"#customdatatype"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Custom Data | Fries"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Fries Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/reference-2.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Custom Data | Fries"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/reference-2.html#webpage",
    "url": "writerside-documentation/reference-2.html",
    "name": "Custom Data | Fries",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Fries Help"
}</script><!-- End Schema.org --></head><body data-id="Reference_2" data-main-title="Custom Data" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Overview.md|Fries Utils Pack 总览"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Fries  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Reference_2" id="Reference_2.md">Custom Data</h1><p id="z38cio7_3">Custom Data 是一个 MonoBehaviour，可以被挂载到任意 GameObject 上<br> 本质上来说，它是一个独立的 GameObject 的 自定义属性字典<br> 使用者可以定义 Custom Data Row (简称为属性) 的键，值类型，和值 并且提供了在同一 GameObject 下的便捷取值方法</p><section class="chapter"><h2 id="z38cio7_4" data-toc="z38cio7_4">三种不同的 属性</h2><p id="z38cio7_11">Custom Data 提供两种不同的属性，它们分别是 持久数据（属性） 与 运行时数据（属性）</p><p id="z38cio7_12"><span id="z38cio7_16"><font style="color:#808080">（最早设计的时候没有考虑过 Runtime 的应用场景，这个是后来加进去的）</font></span></p><p id="z38cio7_13">持久数据 只支持在 Inspector 中赋值，不支持在任何时候通过代码更改这个属性<br> 运行时数据 支持在 代码的任意地点赋值，并在游戏结束时丢失</p><div class="table-wrapper"><table class="wide" id="z38cio7_14"><thead><tr class="ijRowHead" id="z38cio7_18"><th id="z38cio7_21" width="70"><p>类型</p></th><th id="z38cio7_22" width="70"><p>Inspector赋值</p></th><th id="z38cio7_23" width="40"><p>代码赋值</p></th><th id="z38cio7_24" width="40"><p>允许的值类型</p></th><th id="z38cio7_25" width="40"><p>值有效时间</p></th><th id="z38cio7_26" width="40"><p>代码取值</p></th><th id="z38cio7_27" width="40"><p>是否支持全局</p></th></tr></thead><tbody><tr id="z38cio7_19"><td id="z38cio7_28"><p>持久数据</p></td><td id="z38cio7_29"><p>&radic;</p></td><td id="z38cio7_30"><p>&times;</p></td><td id="z38cio7_31"><p>继承 CustomDataType 的类型</p></td><td id="z38cio7_32"><p>值被持久化储存，但是只有MonoBehaviour实例Awake后到销毁前可以获取</p></td><td id="z38cio7_33"><p>&radic;</p></td><td id="z38cio7_34"><p>&radic;</p></td></tr><tr id="z38cio7_20"><td id="z38cio7_35"><p>运行时数据</p></td><td id="z38cio7_36"><p>&times;(但可指定 持久数据 运行时建立 运行时数据副本)</p></td><td id="z38cio7_37"><p>&radic;</p></td><td id="z38cio7_38"><p>任意类型</p></td><td id="z38cio7_39"><p>MonoBehaviour实例Awake后到销毁前</p></td><td id="z38cio7_40"><p>&radic;</p></td><td id="z38cio7_41"><p>&times;</p></td></tr></tbody></table></div><p id="z38cio7_15">除此之外，持久数据中存在全局属性。全局属性是一种持久数据，它可以在代码全局按 名字 静态搜索，无需通过特定 GameObject 或 CustomData。 <br> 所有 持久数据 支持在 MonoBehaviour Awake时初始化一个 运行时数据备份</p></section><section class="chapter"><h2 id="z38cio7_5" data-toc="z38cio7_5">快速开始</h2><ol class="list _decimal" id="z38cio7_43" type="1"><li class="list__item" id="z38cio7_44"><p id="z38cio7_54">挂载 CustomData 到 GameObject 上</p><ul class="list _bullet" id="z38cio7_55"><li class="list__item" id="z38cio7_56"><p id="z38cio7_57">尽量不要一个 GameObject 上有多个 CustomData，因为所有便捷的拓展方法依赖 ComponentCache，只支持单 CustomData 的 GameObject</p></li></ul></li><li class="list__item" id="z38cio7_45"><p id="z38cio7_58">点击 CustomData 在 Inspector 中的 Add Data</p></li><li class="list__item" id="z38cio7_46"><p id="z38cio7_59">选择你需要的值的类型<br><figure id="z38cio7_61"><img alt="Add Data Window.png" src="Fries-Documentation/Add%20Data%20Window.png" title="Add Data Window.png" width="160" height="214"></figure></p></li><li class="list__item" id="z38cio7_47"><p id="z38cio7_62">对于全局数据，请使用 GlobalDataDeclarer，它的值类型是 Unity.Object</p></li><li class="list__item" id="z38cio7_48"><p id="z38cio7_63">对于列表数据，在 2023及以上版本中 请使用非 Legacy版；在 2022 中请使用 Legacy 版</p></li><li class="list__item" id="z38cio7_49"><p id="z38cio7_64">定义该属性的名称 <figure id="z38cio7_65"><img alt="Set Data Name (Custom Data).png" src="Fries-Documentation/Set%20Data%20Name%20(Custom%20Data).png" title="Set Data Name (Custom Data).png" width="472" height="163"></figure></p></li><li class="list__item" id="z38cio7_50"><p id="z38cio7_66">设置该属性的值 <figure id="z38cio7_67"><img alt="Set Data Value (Custom Data).png" src="Fries-Documentation/Set%20Data%20Value%20(Custom%20Data).png" title="Set Data Value (Custom Data).png" width="699" height="82"></figure></p></li><li class="list__item" id="z38cio7_51"><p id="z38cio7_68">可以展开右上角的三角形菜单来移除该数据 / 创建 运行时数据副本 <figure id="z38cio7_69"><img alt="Menu (Custom Data).png" src="Fries-Documentation/Menu%20(Custom%20Data).png" title="Menu (Custom Data).png" width="256" height="163"></figure></p></li><li class="list__item" id="z38cio7_52"><p id="z38cio7_70">创建 运行时数据副本 成功后，可以在该属性左侧看到一个 红点图标 <figure id="z38cio7_71"><img alt="Runtime Copy (Custom Data).png" src="Fries-Documentation/Runtime%20Copy%20(Custom%20Data).png" title="Runtime Copy (Custom Data).png" width="697" height="73"></figure></p></li><li class="list__item" id="z38cio7_53"><p id="z38cio7_72">游戏运行后，可以看到所有 运行时数据 的 值.ToString() 和 内存地址 <figure id="z38cio7_73"><img alt="Runtime View (Custom Data).png" src="Fries-Documentation/Runtime%20View%20(Custom%20Data).png" title="Runtime View (Custom Data).png" width="715" height="151"></figure></p></li></ol></section><section class="chapter"><h2 id="customdata" data-toc="customdata">CustomData 扩展方法文档</h2><p id="z38cio7_74">为 Unity <code class="code" id="z38cio7_79">MonoBehaviour</code>/<code class="code" id="z38cio7_80">GameObject</code> 提供访问 <span class="control" id="z38cio7_81">CustomData</span> 组件的数据与运行时数据（Runtime Data）的便捷扩展方法。本文档遵循 Writerside 的 Markdown 语法与约定，并使用提示/注意/警告等说明块。</p><aside class="prompt" data-type="tip" data-title="" id="z38cio7_75"><p id="z38cio7_82">若对象上缺少 <code class="code" id="z38cio7_84">CustomData</code> 组件：</p><ul class="list _bullet" id="z38cio7_83"><li class="list__item" id="z38cio7_85"><p id="z38cio7_87">某些方法内部已做空检查并安全返回（如 <code class="code" id="z38cio7_88">hasRuntimeData</code>、 <code class="code" id="z38cio7_89">getRuntimeDataOrNull&lt;T&gt;</code>、 <code class="code" id="z38cio7_90">getRuntimeDataOrDefault&lt;T&gt;</code>）。</p></li><li class="list__item" id="z38cio7_86"><p id="z38cio7_91">其余方法会直接调用 <code class="code" id="z38cio7_92">getComponent&lt;CustomData&gt;()</code> ，通常需要确保组件存在，否则可能出现空引用问题。</p></li></ul></aside><section class="chapter"><h3 id="z38cio7_76" data-toc="z38cio7_76">适用范围与前置条件</h3><ul class="list _bullet" id="z38cio7_93"><li class="list__item" id="z38cio7_94"><p id="z38cio7_97">Unity C# 扩展方法，目标类型： <code class="code" id="z38cio7_98">MonoBehaviour</code>、 <code class="code" id="z38cio7_99">GameObject</code></p></li><li class="list__item" id="z38cio7_95"><p id="z38cio7_100">依赖组件： <code class="code" id="z38cio7_101">CustomData</code></p></li><li class="list__item" id="z38cio7_96"><p id="z38cio7_102">键值： <code class="code" id="z38cio7_103">key</code> 为字符串，区分大小写</p></li></ul></section><section class="chapter"><h3 id="z38cio7_77" data-toc="z38cio7_77">快速示例</h3><div class="code-block" data-lang="none">
// 读取 持久数据
var hp = player.getData&lt;int&gt;(&quot;hp&quot;);
bool hasLevel = player.hasData(&quot;level&quot;);
bool hasInventory = player.hasData&lt;List&lt;Item&gt;&gt;(&quot;inventory&quot;);
bool hasTypeMatch = player.hasData(&quot;score&quot;, &quot;System.Int32&quot;);

// 操作 运行时数据
player.setRuntimeData(&quot;buff&quot;, new AttackBuff(10));
bool hasBuff = player.hasRuntimeData(&quot;buff&quot;);
var buff = player.getRuntimeDataOrNull&lt;AttackBuff&gt;(&quot;buff&quot;);
var target = gameObject.getRuntimeDataOrDefault(&quot;target&quot;, defaultValue: null);
</div><aside class="prompt" data-type="tip" data-title="" id="z38cio7_105"><p id="z38cio7_107"><span class="control" id="z38cio7_109">持久数据 与 运行时数据</span>：</p><ul class="list _bullet" id="z38cio7_108"><li class="list__item" id="z38cio7_110"><p id="z38cio7_112"><code class="code" id="z38cio7_113">getData*</code>/<code class="code" id="z38cio7_114">hasData*</code> 访问 <span class="control" id="z38cio7_115">持久数据</span> （由 <code class="code" id="z38cio7_116">CustomData</code> 负责持久化保存，通常可序列化）。</p></li><li class="list__item" id="z38cio7_111"><p id="z38cio7_117"><code class="code" id="z38cio7_118">*RuntimeData*</code> 访问 <span class="control" id="z38cio7_119">运行时数据</span> （仅内存存在，随场景/对象生命周期失效）。</p></li></ul></aside></section><section class="chapter"><h3 id="z38cio7_78" data-toc="z38cio7_78">方法总览</h3><div class="table-wrapper"><table class="wide" id="z38cio7_120"><thead><tr class="ijRowHead" id="z38cio7_122"><th id="z38cio7_132"><p>分组</p></th><th id="z38cio7_133"><p>方法</p></th><th id="z38cio7_134"><p>目标</p></th><th id="z38cio7_135"><p>简要说明</p></th><th id="z38cio7_136"><p>当缺少 <code class="code" id="z38cio7_137">CustomData</code></p></th></tr></thead><tbody><tr id="z38cio7_123"><td id="z38cio7_138"><p>持久</p></td><td id="z38cio7_139"><p><code class="code" id="z38cio7_143">getData&lt;T&gt;(key)</code></p></td><td id="z38cio7_140"><p><code class="code" id="z38cio7_144">MonoBehaviour</code>/<code class="code" id="z38cio7_145">GameObject</code></p></td><td id="z38cio7_141"><p>读取键 <code class="code" id="z38cio7_146">key</code> 的持久数据并转为 <code class="code" id="z38cio7_147">T</code>。</p></td><td id="z38cio7_142"><p>未做空保护，需确保组件存在。</p></td></tr><tr id="z38cio7_124"><td id="z38cio7_148"><p>持久</p></td><td id="z38cio7_149"><p><code class="code" id="z38cio7_153">hasData(key, type)</code></p></td><td id="z38cio7_150"><p><code class="code" id="z38cio7_154">MonoBehaviour</code>/<code class="code" id="z38cio7_155">GameObject</code></p></td><td id="z38cio7_151"><p>判断是否存在键且类型名匹配（字符串形式）。</p></td><td id="z38cio7_152"><p>未做空保护。</p></td></tr><tr id="z38cio7_125"><td id="z38cio7_156"><p>持久</p></td><td id="z38cio7_157"><p><code class="code" id="z38cio7_161">hasData(key)</code></p></td><td id="z38cio7_158"><p><code class="code" id="z38cio7_162">MonoBehaviour</code>/<code class="code" id="z38cio7_163">GameObject</code></p></td><td id="z38cio7_159"><p>判断是否存在键（不校验类型）。</p></td><td id="z38cio7_160"><p>未做空保护。</p></td></tr><tr id="z38cio7_126"><td id="z38cio7_164"><p>持久</p></td><td id="z38cio7_165"><p><code class="code" id="z38cio7_169">hasData&lt;T&gt;(key)</code></p></td><td id="z38cio7_166"><p><code class="code" id="z38cio7_170">MonoBehaviour</code>/<code class="code" id="z38cio7_171">GameObject</code></p></td><td id="z38cio7_167"><p>判断是否存在键且可转换为泛型 <code class="code" id="z38cio7_172">T</code>。</p></td><td id="z38cio7_168"><p>未做空保护。</p></td></tr><tr id="z38cio7_127"><td id="z38cio7_173"><p>运行时</p></td><td id="z38cio7_174"><p><code class="code" id="z38cio7_178">hasRuntimeData(key)</code></p></td><td id="z38cio7_175"><p><code class="code" id="z38cio7_179">MonoBehaviour</code>/<code class="code" id="z38cio7_180">GameObject</code></p></td><td id="z38cio7_176"><p>安全判断是否存在键（带空组件检查）。</p></td><td id="z38cio7_177"><p><span class="control" id="z38cio7_181">安全</span> ：若无组件返回 <code class="code" id="z38cio7_182">false</code>。</p></td></tr><tr id="z38cio7_128"><td id="z38cio7_183"><p>运行时</p></td><td id="z38cio7_184"><p><code class="code" id="z38cio7_188">setRuntimeData(key, value)</code></p></td><td id="z38cio7_185"><p><code class="code" id="z38cio7_189">MonoBehaviour</code>/<code class="code" id="z38cio7_190">GameObject</code></p></td><td id="z38cio7_186"><p>写入/覆盖运行时数据。</p></td><td id="z38cio7_187"><p>未做空保护。</p></td></tr><tr id="z38cio7_129"><td id="z38cio7_191"><p>运行时</p></td><td id="z38cio7_192"><p><code class="code" id="z38cio7_196">getRuntimeData&lt;T&gt;(key)</code></p></td><td id="z38cio7_193"><p><code class="code" id="z38cio7_197">MonoBehaviour</code>/<code class="code" id="z38cio7_198">GameObject</code></p></td><td id="z38cio7_194"><p>读取运行时数据并转为 <code class="code" id="z38cio7_199">T</code>。</p></td><td id="z38cio7_195"><p>未做空保护。</p></td></tr><tr id="z38cio7_130"><td id="z38cio7_200"><p>运行时</p></td><td id="z38cio7_201"><p><code class="code" id="z38cio7_205">getRuntimeDataOrNull&lt;T&gt;(key)</code></p></td><td id="z38cio7_202"><p><code class="code" id="z38cio7_206">MonoBehaviour</code>/<code class="code" id="z38cio7_207">GameObject</code></p></td><td id="z38cio7_203"><p>安全读取；若无组件或无键返回 <code class="code" id="z38cio7_208">null</code>。</p></td><td id="z38cio7_204"><p><span class="control" id="z38cio7_209">安全</span> ：可能返回 <code class="code" id="z38cio7_210">null</code>。</p></td></tr><tr id="z38cio7_131"><td id="z38cio7_211"><p>运行时</p></td><td id="z38cio7_212"><p><code class="code" id="z38cio7_216">getRuntimeDataOrDefault&lt;T&gt;(key, defaultValue)</code></p></td><td id="z38cio7_213"><p><code class="code" id="z38cio7_217">MonoBehaviour</code>/<code class="code" id="z38cio7_218">GameObject</code></p></td><td id="z38cio7_214"><p>安全读取；失败时返回指定默认值。</p></td><td id="z38cio7_215"><p><span class="control" id="z38cio7_219">安全</span> ：返回 <code class="code" id="z38cio7_220">defaultValue</code>。</p></td></tr></tbody></table></div></section></section><section class="chapter"><h2 id="api" data-toc="api">API 详细说明</h2><section class="chapter"><h3 id="getdata-t-key" data-toc="getdata-t-key">getData&lt;T&gt;(key)</h3><p id="z38cio7_232"><span class="control" id="z38cio7_245">签名</span></p><div class="code-block" data-lang="none">
public static T getData&lt;T&gt;(this MonoBehaviour mono, string key)
public static T getData&lt;T&gt;(this GameObject gobj, string key)
</div><p id="z38cio7_234"><span class="control" id="z38cio7_246">参数</span></p><ul class="list _bullet" id="z38cio7_235"><li class="list__item" id="z38cio7_247"><p id="z38cio7_248"><code class="code" id="z38cio7_249">key</code> ：要读取的数据键。</p></li></ul><p id="z38cio7_236"><span class="control" id="z38cio7_250">类型参数</span></p><ul class="list _bullet" id="z38cio7_237"><li class="list__item" id="z38cio7_251"><p id="z38cio7_252"><code class="code" id="z38cio7_253">T</code> ：目标数据类型。</p></li></ul><p id="z38cio7_238"><span class="control" id="z38cio7_254">返回</span></p><ul class="list _bullet" id="z38cio7_239"><li class="list__item" id="z38cio7_255"><p id="z38cio7_256">键 <code class="code" id="z38cio7_257">key</code> 对应的数据并转换为 <code class="code" id="z38cio7_258">T</code>。</p></li></ul><p id="z38cio7_240"><span class="control" id="z38cio7_259">行为与注意</span></p><aside class="prompt" data-type="note" data-title="" id="z38cio7_241"><p id="z38cio7_260">该方法未进行空组件检查；请确保目标对象上存在 <code class="code" id="z38cio7_261">CustomData</code> 。如果键不存在或类型不兼容，行为取决于 <code class="code" id="z38cio7_262">CustomData.getData&lt;T&gt;</code> 的实现&mdash;&mdash;可能抛出异常或返回默认值。建议在读取前先用 <code class="code" id="z38cio7_263">hasData*</code> 判断。</p></aside><p id="z38cio7_242"><span class="control" id="z38cio7_264">示例</span></p><div class="code-block" data-lang="none">
int hp = player.getData&lt;int&gt;(&quot;hp&quot;);
var inventory = gameObject.getData&lt;List&lt;Item&gt;&gt;(&quot;inventory&quot;);
</div></section><section class="chapter"><h3 id="hasdata-key-type" data-toc="hasdata-key-type">hasData(key, type)</h3><p id="z38cio7_265"><span class="control" id="z38cio7_274">签名</span></p><div class="code-block" data-lang="none">
public static bool hasData(this MonoBehaviour mono, string key, string type)
public static bool hasData(this GameObject gobj, string key, string type)
</div><p id="z38cio7_267"><span class="control" id="z38cio7_275">参数</span></p><ul class="list _bullet" id="z38cio7_268"><li class="list__item" id="z38cio7_276"><p id="z38cio7_278"><code class="code" id="z38cio7_279">key</code> ：数据键。</p></li><li class="list__item" id="z38cio7_277"><p id="z38cio7_280"><code class="code" id="z38cio7_281">type</code> ：目标类型的限定名字符串（例如： <code class="code" id="z38cio7_282">&quot;System.Int32&quot;</code> 或自定义类型的完整限定名）。</p></li></ul><p id="z38cio7_269"><span class="control" id="z38cio7_283">返回</span></p><ul class="list _bullet" id="z38cio7_270"><li class="list__item" id="z38cio7_284"><p id="z38cio7_285">若存在键且其类型名与 <code class="code" id="z38cio7_286">type</code> 匹配则 <code class="code" id="z38cio7_287">true</code> ，否则 <code class="code" id="z38cio7_288">false</code>。</p></li></ul><p id="z38cio7_271"><span class="control" id="z38cio7_289">示例</span></p><div class="code-block" data-lang="none">
bool ok = player.hasData(&quot;score&quot;, &quot;System.Int32&quot;);
</div></section><section class="chapter"><h3 id="hasdata-key" data-toc="hasdata-key">hasData(key)</h3><p id="z38cio7_290"><span class="control" id="z38cio7_299">签名</span></p><div class="code-block" data-lang="none">
public static bool hasData(this MonoBehaviour mono, string key)
public static bool hasData(this GameObject gobj, string key)
</div><p id="z38cio7_292"><span class="control" id="z38cio7_300">参数</span></p><ul class="list _bullet" id="z38cio7_293"><li class="list__item" id="z38cio7_301"><p id="z38cio7_302"><code class="code" id="z38cio7_303">key</code> ：数据键。</p></li></ul><p id="z38cio7_294"><span class="control" id="z38cio7_304">返回</span></p><ul class="list _bullet" id="z38cio7_295"><li class="list__item" id="z38cio7_305"><p id="z38cio7_306">若存在键则 <code class="code" id="z38cio7_307">true</code> ，否则 <code class="code" id="z38cio7_308">false</code>。</p></li></ul><p id="z38cio7_296"><span class="control" id="z38cio7_309">示例</span></p><div class="code-block" data-lang="none">
if (player.hasData(&quot;level&quot;)) {
    int level = player.getData&lt;int&gt;(&quot;level&quot;);
}
</div></section><section class="chapter"><h3 id="hasdata-t-key" data-toc="hasdata-t-key">hasData&lt;T&gt;(key)</h3><p id="z38cio7_311"><span class="control" id="z38cio7_322">签名</span></p><div class="code-block" data-lang="none">
public static bool hasData&lt;T&gt;(this MonoBehaviour mono, string key)
public static bool hasData&lt;T&gt;(this GameObject gobj, string key)
</div><p id="z38cio7_313"><span class="control" id="z38cio7_323">类型参数</span></p><ul class="list _bullet" id="z38cio7_314"><li class="list__item" id="z38cio7_324"><p id="z38cio7_325"><code class="code" id="z38cio7_326">T</code> ：要校验的数据类型。</p></li></ul><p id="z38cio7_315"><span class="control" id="z38cio7_327">参数</span></p><ul class="list _bullet" id="z38cio7_316"><li class="list__item" id="z38cio7_328"><p id="z38cio7_329"><code class="code" id="z38cio7_330">key</code> ：数据键。</p></li></ul><p id="z38cio7_317"><span class="control" id="z38cio7_331">返回</span></p><ul class="list _bullet" id="z38cio7_318"><li class="list__item" id="z38cio7_332"><p id="z38cio7_333">若存在键且可转换为 <code class="code" id="z38cio7_334">T</code> 则 <code class="code" id="z38cio7_335">true</code> ，否则 <code class="code" id="z38cio7_336">false</code>。</p></li></ul><p id="z38cio7_319"><span class="control" id="z38cio7_337">示例</span></p><div class="code-block" data-lang="none">
if (player.hasData&lt;List&lt;Item&gt;&gt;(&quot;inventory&quot;)) {
    var items = player.getData&lt;List&lt;Item&gt;&gt;(&quot;inventory&quot;);
}
</div></section><section class="chapter"><h3 id="hasruntimedata-key" data-toc="hasruntimedata-key">hasRuntimeData(key)</h3><p id="z38cio7_338"><span class="control" id="z38cio7_347">签名</span></p><div class="code-block" data-lang="none">
public static bool hasRuntimeData(this MonoBehaviour mono, string key)
public static bool hasRuntimeData(this GameObject gobj, string key)
</div><p id="z38cio7_340"><span class="control" id="z38cio7_348">参数</span></p><ul class="list _bullet" id="z38cio7_341"><li class="list__item" id="z38cio7_349"><p id="z38cio7_350"><code class="code" id="z38cio7_351">key</code> ：运行时数据键。</p></li></ul><p id="z38cio7_342"><span class="control" id="z38cio7_352">返回</span></p><ul class="list _bullet" id="z38cio7_343"><li class="list__item" id="z38cio7_353"><p id="z38cio7_354">存在返回 <code class="code" id="z38cio7_355">true</code> ；若目标上无 <code class="code" id="z38cio7_356">CustomData</code> 组件或不存在该键，返回 <code class="code" id="z38cio7_357">false</code>。</p></li></ul><p id="z38cio7_344"><span class="control" id="z38cio7_358">示例</span></p><div class="code-block" data-lang="none">
if (gameObject.hasRuntimeData(&quot;buff&quot;)) {
    // ...
}
</div></section><section class="chapter"><h3 id="setruntimedata-key-value" data-toc="setruntimedata-key-value">setRuntimeData(key, value)</h3><p id="z38cio7_359"><span class="control" id="z38cio7_368">签名</span></p><div class="code-block" data-lang="none">
public static void setRuntimeData(this MonoBehaviour mono, string key, object value)
public static void setRuntimeData(this GameObject gobj, string key, object value)
</div><p id="z38cio7_361"><span class="control" id="z38cio7_369">参数</span></p><ul class="list _bullet" id="z38cio7_362"><li class="list__item" id="z38cio7_370"><p id="z38cio7_372"><code class="code" id="z38cio7_373">key</code> ：运行时数据键。</p></li><li class="list__item" id="z38cio7_371"><p id="z38cio7_374"><code class="code" id="z38cio7_375">value</code> ：要写入的对象。</p></li></ul><p id="z38cio7_363"><span class="control" id="z38cio7_376">行为与注意</span></p><ul class="list _bullet" id="z38cio7_364"><li class="list__item" id="z38cio7_377"><p id="z38cio7_379">若键已存在则覆盖。</p></li><li class="list__item" id="z38cio7_378"><p id="z38cio7_380">方法未做空组件检查，需确保存在 <code class="code" id="z38cio7_381">CustomData</code>。</p></li></ul><p id="z38cio7_365"><span class="control" id="z38cio7_382">示例</span></p><div class="code-block" data-lang="none">
player.setRuntimeData(&quot;target&quot;, enemy);
</div></section><section class="chapter"><h3 id="getruntimedata-t-key" data-toc="getruntimedata-t-key">getRuntimeData&lt;T&gt;(key)</h3><p id="z38cio7_384"><span class="control" id="z38cio7_397">签名</span></p><div class="code-block" data-lang="none">
public static T getRuntimeData&lt;T&gt;(this MonoBehaviour mono, string key)
public static T getRuntimeData&lt;T&gt;(this GameObject gobj, string key)
</div><p id="z38cio7_386"><span class="control" id="z38cio7_398">参数</span></p><ul class="list _bullet" id="z38cio7_387"><li class="list__item" id="z38cio7_399"><p id="z38cio7_400"><code class="code" id="z38cio7_401">key</code> ：运行时数据键。</p></li></ul><p id="z38cio7_388"><span class="control" id="z38cio7_402">类型参数</span></p><ul class="list _bullet" id="z38cio7_389"><li class="list__item" id="z38cio7_403"><p id="z38cio7_404"><code class="code" id="z38cio7_405">T</code> ：目标数据类型。</p></li></ul><p id="z38cio7_390"><span class="control" id="z38cio7_406">返回</span></p><ul class="list _bullet" id="z38cio7_391"><li class="list__item" id="z38cio7_407"><p id="z38cio7_408">将运行时数据转换为 <code class="code" id="z38cio7_409">T</code> 后返回。</p></li></ul><p id="z38cio7_392"><span class="control" id="z38cio7_410">行为与注意</span></p><aside class="prompt" data-type="note" data-title="" id="z38cio7_393"><p id="z38cio7_411">未做空组件检查；若键不存在或类型不兼容，行为取决于 <code class="code" id="z38cio7_412">CustomData.getRuntimeData&lt;T&gt;</code> 的实现。可以优先考虑使用 <code class="code" id="z38cio7_413">hasRuntimeData</code> 或下述两个&ldquo;安全读取&rdquo;重载。</p></aside><p id="z38cio7_394"><span class="control" id="z38cio7_414">示例</span></p><div class="code-block" data-lang="none">
var target = player.getRuntimeData&lt;Transform&gt;(&quot;target&quot;);
</div></section><section class="chapter"><h3 id="getruntimedataornull-t-key" data-toc="getruntimedataornull-t-key">getRuntimeDataOrNull&lt;T&gt;(key)</h3><p id="z38cio7_416"><span class="control" id="z38cio7_427">签名</span></p><div class="code-block" data-lang="none">
public static T getRuntimeDataOrNull&lt;T&gt;(this MonoBehaviour mono, string key)
public static T getRuntimeDataOrNull&lt;T&gt;(this GameObject gobj, string key)
</div><p id="z38cio7_418"><span class="control" id="z38cio7_428">参数</span></p><ul class="list _bullet" id="z38cio7_419"><li class="list__item" id="z38cio7_429"><p id="z38cio7_430"><code class="code" id="z38cio7_431">key</code> ：运行时数据键。</p></li></ul><p id="z38cio7_420"><span class="control" id="z38cio7_432">类型参数</span></p><ul class="list _bullet" id="z38cio7_421"><li class="list__item" id="z38cio7_433"><p id="z38cio7_434"><code class="code" id="z38cio7_435">T</code> ：目标数据类型（建议为引用类型或 <code class="code" id="z38cio7_436">Nullable&lt;T&gt;</code>）。</p></li></ul><p id="z38cio7_422"><span class="control" id="z38cio7_437">返回</span></p><ul class="list _bullet" id="z38cio7_423"><li class="list__item" id="z38cio7_438"><p id="z38cio7_439">若存在并类型兼容，返回值；否则返回 <code class="code" id="z38cio7_440">null</code> 。若 <code class="code" id="z38cio7_441">CustomData</code> 不存在，同样返回 <code class="code" id="z38cio7_442">null</code>。</p></li></ul><p id="z38cio7_424"><span class="control" id="z38cio7_443">示例</span></p><div class="code-block" data-lang="none">
var buff = player.getRuntimeDataOrNull&lt;AttackBuff&gt;(&quot;buff&quot;);
if (buff != null) buff.Apply();
</div></section><section class="chapter"><h3 id="getruntimedataordefault-t-key-defaultvalue" data-toc="getruntimedataordefault-t-key-defaultvalue">getRuntimeDataOrDefault&lt;T&gt;(key, defaultValue)</h3><p id="z38cio7_445"><span class="control" id="z38cio7_456">签名</span></p><div class="code-block" data-lang="none">
public static T getRuntimeDataOrDefault&lt;T&gt;(this MonoBehaviour mono, string key, T defaultValue)
public static T getRuntimeDataOrDefault&lt;T&gt;(this GameObject gobj, string key, T defaultValue)
</div><p id="z38cio7_447"><span class="control" id="z38cio7_457">参数</span></p><ul class="list _bullet" id="z38cio7_448"><li class="list__item" id="z38cio7_458"><p id="z38cio7_460"><code class="code" id="z38cio7_461">key</code> ：运行时数据键。</p></li><li class="list__item" id="z38cio7_459"><p id="z38cio7_462"><code class="code" id="z38cio7_463">defaultValue</code> ：当无组件或不存在该键时返回的默认值。</p></li></ul><p id="z38cio7_449"><span class="control" id="z38cio7_464">类型参数</span></p><ul class="list _bullet" id="z38cio7_450"><li class="list__item" id="z38cio7_465"><p id="z38cio7_466"><code class="code" id="z38cio7_467">T</code> ：目标数据类型。</p></li></ul><p id="z38cio7_451"><span class="control" id="z38cio7_468">返回</span></p><ul class="list _bullet" id="z38cio7_452"><li class="list__item" id="z38cio7_469"><p id="z38cio7_470">存在返回实际值；否则返回 <code class="code" id="z38cio7_471">defaultValue</code>。</p></li></ul><p id="z38cio7_453"><span class="control" id="z38cio7_472">示例</span></p><div class="code-block" data-lang="none">
var target = player.getRuntimeDataOrDefault&lt;Transform&gt;(&quot;target&quot;, null);
int stacks = player.getRuntimeDataOrDefault&lt;int&gt;(&quot;stacks&quot;, 0);
</div></section><section class="chapter"><h3 id="z38cio7_230" data-toc="z38cio7_230">设计建议</h3><ul class="list _bullet" id="z38cio7_473"><li class="list__item" id="z38cio7_474"><p id="z38cio7_477"><span class="control" id="z38cio7_478">组件获取</span> ：若频繁调用，无需考虑自行缓存 <code class="code" id="z38cio7_479">CustomData</code> 引用以减少 <code class="code" id="z38cio7_480">getComponent&lt;CustomData&gt;()</code> 开销。因为 getComponent 方法由 ComponentCache 提供，本身存在缓存功能。但是请确保 该 GameObject 上不存在多个 CustomData</p></li><li class="list__item" id="z38cio7_475"><p id="z38cio7_481"><span class="control" id="z38cio7_482">空安全读取</span> ：读取运行时数据时，优先使用 <code class="code" id="z38cio7_483">hasRuntimeData</code>/<code class="code" id="z38cio7_484">getRuntimeDataOrDefault</code> ，以减少异常分支。</p></li><li class="list__item" id="z38cio7_476"><p id="z38cio7_485"><span class="control" id="z38cio7_486">线程安全</span> ：未保证线程安全，建议在主线程/Unity 生命周期内使用。</p></li></ul></section></section><section class="chapter"><h2 id="customdatatype" data-toc="customdatatype">自定义 <code class="code" id="z38cio7_495">CustomDataType</code> 引导</h2><aside class="prompt" data-type="note" data-title="" id="z38cio7_488"><p id="z38cio7_496">本节说明如何<span class="control" id="z38cio7_497">新增一种数据类型</span> ，让它可以在 <code class="code" id="z38cio7_498">CustomData</code> 的**持久数据（dataStore）**里被创建、序列化、在检视器中显示，并能被 <code class="code" id="z38cio7_499">getData&lt;T&gt;()</code> 正确读取。</p></aside><section class="chapter"><h3 id="z38cio7_490" data-toc="z38cio7_490">设计总览</h3><p id="z38cio7_500">你需要实现两个类：</p><ol class="list _decimal" id="z38cio7_501" type="1"><li class="list__item" id="z38cio7_505"><p id="z38cio7_507"><span class="control" id="z38cio7_509">去包装类型（Unwrapper）</span></p><ul class="list _bullet" id="z38cio7_508"><li class="list__item" id="z38cio7_510"><p id="z38cio7_512">这是实际被序列化进 <code class="code" id="z38cio7_513">CustomData</code> 的对象（例如 <code class="code" id="z38cio7_514">StringWrapper</code>）。</p></li><li class="list__item" id="z38cio7_511"><p id="z38cio7_515">它需要实现 <code class="code" id="z38cio7_516">Unwrapper</code> 方法，让运行时读取时能还原为&ldquo;真实值&rdquo;（例如 <code class="code" id="z38cio7_517">string</code>）。</p></li></ul></li><li class="list__item" id="z38cio7_506"><p id="z38cio7_518"><span class="control" id="z38cio7_520">类型描述（CustomDataType）</span></p><ul class="list _bullet" id="z38cio7_519"><li class="list__item" id="z38cio7_521"><p id="z38cio7_523">定义显示名（用于编辑器弹窗）、对应的 <span class="control" id="z38cio7_524">数据类型</span> （用于注册/比对）、以及默认值（用于&ldquo;Add Data&rdquo;时创建初值）。</p></li><li class="list__item" id="z38cio7_522"><p id="z38cio7_525">注意，类型描述不一定要对应一个 去包装类型，它可以对应并载入一个普通类型，只要这种类型可以被 Unity 正常序列化</p></li></ul></li></ol><p id="z38cio7_502"><code class="code" id="z38cio7_526">CustomDataTypes.init()</code> 会通过反射扫描所有实现了 <code class="code" id="z38cio7_527">CustomDataType</code> 的类，并以 <code class="code" id="z38cio7_528">getType().ToString()</code> 作为键缓存到 <code class="code" id="z38cio7_529">cachedTypes</code> 中。编辑器的&ldquo;Add Data&rdquo;弹窗与 <code class="code" id="z38cio7_530">CustomData</code> 的 Inspector 就是依赖这份缓存来显示/创建数据项。</p><aside class="prompt" data-type="warning" data-title="" id="z38cio7_503"><p id="z38cio7_531"><span class="control" id="z38cio7_532">命名重要性</span>： <code class="code" id="z38cio7_533">type</code> 被持久化为 <code class="code" id="z38cio7_534">string</code> （<code class="code" id="z38cio7_535">getType().ToString()</code> ），若你<span class="control" id="z38cio7_536">重命名类或变更命名空间</span> ，旧数据将无法匹配并显示为&ldquo;未知类型&rdquo;。在正式项目中，建议避免随意改动类型名，或在必要时做新数据类型的 CustomDataType 或做迁移脚本。</p></aside></section><section class="chapter"><h3 id="z38cio7_491" data-toc="z38cio7_491">生命周期与注册</h3><ul class="list _bullet" id="z38cio7_537"><li class="list__item" id="z38cio7_540"><p id="z38cio7_541"><code class="code" id="z38cio7_543">CustomDataTypes.init()</code> 带有</p><ul class="list _bullet" id="z38cio7_542"><li class="list__item" id="z38cio7_544"><p id="z38cio7_547"><code class="code" id="z38cio7_548">RuntimeInitializeOnLoadMethod</code> （运行时，场景 <code class="code" id="z38cio7_549">Awake</code> 之后触发）</p></li><li class="list__item" id="z38cio7_545"><p id="z38cio7_550">在随后的更新中，会将该方法调整为 场景中物体 <code class="code" id="z38cio7_551">Awake</code> 之前触发</p></li><li class="list__item" id="z38cio7_546"><p id="z38cio7_552"><code class="code" id="z38cio7_553">InitializeOnLoadMethod</code> （编辑器脚本重载后触发）</p></li></ul></li></ul><aside class="prompt" data-type="note" data-title="" id="z38cio7_538"><p id="z38cio7_554">另外， <code class="code" id="z38cio7_555">CustomDataTypes.init()</code> 中 <code class="code" id="z38cio7_556">Activator.CreateInstance(type)</code> 要求 CustomDataType实现类 提供<span class="control" id="z38cio7_557">无参构造函数</span> ；否则会抛异常。</p></aside></section><section class="chapter"><h3 id="unwrapper" data-toc="unwrapper">Unwrapper类 的实际作用</h3><p id="z38cio7_558"><code class="code" id="z38cio7_564">CustomData.getData&lt;T&gt;(string key)</code> （节选）：</p><div class="code-block" data-lang="none">
if (_dataDictionary[key].value == null) return (T)(object)null;
if (_dataDictionary[key].value is T)
    return _dataDictionary[key].getValue&lt;T&gt;();
if (_dataDictionary[key].value is Unwrapper unwrapper) {
    var v = unwrapper.unwrap();   // &lt;- 用 Wrapper 解包
    return (T)v;                  // &lt;- 尝试转为 T
}
throw new InvalidEnumArgumentException(&quot;No valid data is found! ...&quot;);
</div><p id="z38cio7_560">这意味着：</p><ul class="list _bullet" id="z38cio7_561"><li class="list__item" id="z38cio7_565"><p id="z38cio7_566"><span class="control" id="z38cio7_567">CustomDataType类 中指向的数据类 如果实现了 <code class="code" id="z38cio7_570">Unwrapper</code></span> ，那么在获取到该数据后，在类型转换时会尝试调用 <code class="code" id="z38cio7_568">unwrap()</code> 方法得到预期类型为 <code class="code" id="z38cio7_569">T</code> 的数据。</p></li></ul><aside class="prompt" data-type="warning" data-title="" id="z38cio7_562"><p id="z38cio7_571">当 <code class="code" id="z38cio7_572">value == null</code> 时，它会直接返回 <code class="code" id="z38cio7_573">(T)(object)null</code> ：若 <code class="code" id="z38cio7_574">T</code> 是<span class="control" id="z38cio7_575">非可空值类型</span> （如 <code class="code" id="z38cio7_576">int</code> ），会导致运行期异常。此时建议用 <code class="code" id="z38cio7_577">T?</code> 或改用 <code class="code" id="z38cio7_578">getRuntimeDataOrDefault</code> 这类有兜底的方法。</p></aside></section><section class="chapter"><h3 id="int" data-toc="int">最小实践：新增一个 <code class="code" id="z38cio7_584">int</code> 类型</h3><p id="z38cio7_580">下面以 <code class="code" id="z38cio7_585">int</code> 为例，展示<span class="control" id="z38cio7_586">完整、可运行</span>的最简实现。</p><section class="chapter"><h4 id="1-intwrapper" data-toc="1-intwrapper">1) 定义 <code class="code" id="z38cio7_590">IntWrapper</code></h4><div class="code-block" data-lang="none">
using System;
using UnityEngine;

[Serializable] // 确保 Unity 能序列化
public class IntWrapper : Unwrapper {
    public int value = 0;

    public object unwrap() {
        return value; // 将被 getData&lt;int&gt;() 拿到并强转为 int
    }
}
</div><aside class="prompt" data-type="tip" data-title="" id="z38cio7_589"><p id="z38cio7_591">字段建议设为 <code class="code" id="z38cio7_592">public</code> 或 <code class="code" id="z38cio7_593">[SerializeField]</code> ，以让 Unity/Inspector 正常绘制与序列化。</p></aside></section><section class="chapter"><h4 id="2-intcustomdata" data-toc="2-intcustomdata">2) 定义 <code class="code" id="z38cio7_596">IntCustomData</code></h4><div class="code-block" data-lang="none">
public class IntCustomData : CustomDataType {
    public string getDisplayName() {
        return &quot;Int&quot;;
    }

    public Type getType() {
        return typeof(IntWrapper); // 注意：返回的是 Wrapper 类型
    }

    public object getDefaultValue() {
        return new IntWrapper();   // 新增数据行时的默认值
    }
}
</div></section><section class="chapter"><h4 id="3-inspector" data-toc="3-inspector">3) (可选但不推荐)自定义 Inspector 绘制</h4><aside class="prompt" data-type="tip" data-title="" id="z38cio7_597"><p id="z38cio7_602">当前 CustomDataEditor 使用 SerializedProperty valueProperty 自动绘制；若需自定义 UI，可为包装器添加 PropertyDrawer。 <br> 但是在未来，该特性可能会被修改</p></aside><p id="z38cio7_598">完成后，进入 Unity：</p><ul class="list _bullet" id="z38cio7_599"><li class="list__item" id="z38cio7_604"><p id="z38cio7_607">代码重编（Editor 侧的 <code class="code" id="z38cio7_608">InitializeOnLoadMethod</code> 会触发）， <span class="control" id="z38cio7_609">Add Data</span> 弹窗应出现 <span class="control" id="z38cio7_610">Int</span>。</p></li><li class="list__item" id="z38cio7_605"><p id="z38cio7_611">在 <code class="code" id="z38cio7_612">CustomData</code> 上添加 <code class="code" id="z38cio7_613">Int</code> 数据，命名为 <code class="code" id="z38cio7_614">hp</code>。</p></li><li class="list__item" id="z38cio7_606"><p id="z38cio7_615">运行时可通过 <code class="code" id="z38cio7_616">getData&lt;int&gt;(&quot;hp&quot;)</code> 读取。</p></li></ul><aside class="prompt" data-type="note" data-title="" id="z38cio7_600"><p id="z38cio7_617">Unity 对<span class="control" id="z38cio7_618">泛型类序列化</span>支持有限且问题多发。建议为<span class="control" id="z38cio7_619">每个具体T类型</span>或者<span class="control" id="z38cio7_620">这些T的父类型</span>写一个专用 CustomDataType。</p></aside></section></section><section class="chapter"><h3 id="z38cio7_494" data-toc="z38cio7_494">调试与排错清单</h3><ul class="list _bullet" id="z38cio7_621"><li class="list__item" id="z38cio7_622"><p id="z38cio7_626"><span class="control" id="z38cio7_628">未出现在&ldquo;Add Data&rdquo;弹窗</span></p><ul class="list _bullet" id="z38cio7_627"><li class="list__item" id="z38cio7_629"><p id="z38cio7_632">确认类实现了 <code class="code" id="z38cio7_633">CustomDataType</code> ，且有<span class="control" id="z38cio7_634">无参构造</span>。</p></li><li class="list__item" id="z38cio7_630"><p id="z38cio7_635">确认 <code class="code" id="z38cio7_636">CustomDataTypes.init()</code> 被调用（脚本重载后会自动；必要时可手动调用一次）。</p></li><li class="list__item" id="z38cio7_631"><p id="z38cio7_637">确认 <code class="code" id="z38cio7_638">getDisplayName()</code> 返回了非空字符串。</p></li></ul></li><li class="list__item" id="z38cio7_623"><p id="z38cio7_639"><span class="control" id="z38cio7_641">创建后 Inspector 不显示字段 / 无法编辑</span></p><ul class="list _bullet" id="z38cio7_640"><li class="list__item" id="z38cio7_642"><p id="z38cio7_644">CustomDataType 所指向的数据类 是否 <code class="code" id="z38cio7_645">[Serializable]</code> ？字段是否 <code class="code" id="z38cio7_646">public</code> 或 <code class="code" id="z38cio7_647">[SerializeField]</code>？</p></li><li class="list__item" id="z38cio7_643"><p id="z38cio7_648">可以尝试不要在 CustomDataType 指向泛型数据类</p></li></ul></li><li class="list__item" id="z38cio7_624"><p id="z38cio7_649"><span class="control" id="z38cio7_651">运行时报&ldquo;类型不匹配&rdquo;</span></p><ul class="list _bullet" id="z38cio7_650"><li class="list__item" id="z38cio7_652"><p id="z38cio7_654">获取数据时，CustomData类 会试图将数据本身的类（CustomDataType所指向的类）转换为指定T类，如果不成功并且数据本身又正好实现了 <code class="code" id="z38cio7_655">Unwrapper</code> ，那么会尝试进行 <code class="code" id="z38cio7_656">unwrap()</code></p></li><li class="list__item" id="z38cio7_653"><p id="z38cio7_657"><code class="code" id="z38cio7_658">unwrap()</code> 返回的对象类型是否能被强制转换为 <code class="code" id="z38cio7_659">T</code>？</p></li></ul></li><li class="list__item" id="z38cio7_625"><p id="z38cio7_660"><span class="control" id="z38cio7_662">数据升级/重命名后丢失</span></p><ul class="list _bullet" id="z38cio7_661"><li class="list__item" id="z38cio7_663"><p id="z38cio7_665">因为用 <code class="code" id="z38cio7_666">getType().ToString()</code> 作为键，改名会导致匹配失败。可编写一次性迁移脚本，批量把旧的 <code class="code" id="z38cio7_667">type</code> 字符串替换为新名。</p></li><li class="list__item" id="z38cio7_664"><p id="z38cio7_668">或者最好为 升级后的数据 制作一个新的 CustomDataType 和对应的 Unwrapper，并同时做好新老版本兼容</p></li></ul></li></ul></section></section><div class="last-modified">17 八月 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="overview.html" class="navigation-links__prev">Fries Utils Pack 总览</a><a href="multi-tag.html" class="navigation-links__next">Multi Tag</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>